<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>E-TODA Support</title>
  <style>
    :root{
      --bg:#dff9e3;
      --text:#0b1a12;
      --muted:rgba(11,26,18,.72);
      --card:#fff;
      --line:rgba(11,26,18,.14);
      --green:#1fa855;
      --green2:#158546;
    }

    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    body{background:var(--bg);color:var(--text)}

    .wrap{max-width:920px;margin:0 auto;padding:18px 24px 40px}

    .card{
      background:var(--card);
      border-radius:22px;
      padding:24px;
      border:1px solid rgba(0,0,0,.06);
      box-shadow:0 14px 35px rgba(0,0,0,.10);
    }

    h1{margin:0 0 8px;font-size:52px;letter-spacing:-1px}
    .sub{margin:0 0 18px;color:var(--muted);line-height:1.4}

    form{display:grid;gap:16px}

    .row{
      display:grid;
      grid-template-columns: minmax(0,1fr) minmax(0,1fr);
      gap:16px;
    }

    .field{display:grid;gap:8px;min-width:0}

    label{
      font-size:13px;
      color:rgba(11,26,18,.85);
      font-weight:800;
    }

    input,select,textarea{
      width:100%;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid var(--line);
      background:#fff;
      outline:none;
      font-size:14px;
      min-width:0;
    }

    input:focus,select:focus,textarea:focus{
      border-color: rgba(31,168,85,.60);
      box-shadow: 0 0 0 4px rgba(31,168,85,.14);
    }

    textarea{min-height:160px;resize:vertical}

    .actions{
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:4px;
    }

    button{
      border:none;
      background:var(--green);
      color:#fff;
      padding:12px 18px;
      border-radius:999px;
      font-weight:900;
      cursor:pointer;
    }
    button:hover{background:var(--green2)}
    button:disabled{opacity:.65;cursor:not-allowed}

    .status{color:var(--muted);font-weight:800}
    .warn{margin:0;color:rgba(11,26,18,.55);font-size:12px;line-height:1.4}

    @media(max-width:720px){
      .row{grid-template-columns:1fr}
      h1{font-size:44px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Support</h1>
      <p class="sub">Send a message to E-TODA support. This will post to Discord via Google Script.</p>

      <!-- ✅ keep id="f" and use it in JS -->
      <form id="f">
        <div class="row">
          <div class="field">
            <label for="name">Name</label>
            <input id="name" required placeholder="Your name">
          </div>

          <div class="field">
            <label for="role">Role</label>
            <select id="role" required>
              <option value="">Select…</option>
              <option>Passenger</option>
              <option>Driver</option>
              <option>Admin</option>
              <option>Other</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label for="contact">Contact (optional)</label>
            <input id="contact" placeholder="Email or phone">
          </div>

          <div class="field">
            <label for="cat">Category</label>
            <select id="cat" required>
              <option value="">Select…</option>
              <option>Booking</option>
              <option>GPS / Tracking</option>
              <option>Login / Account</option>
              <option>Fare</option>
              <option>Bug Report</option>
              <option>Feature Request</option>
              <option>Other</option>
            </select>
          </div>
        </div>

        <div class="field">
          <label for="subj">Subject</label>
          <input id="subj" required maxlength="90" placeholder="Short title">
        </div>

        <div class="field">
          <label for="msg">Message</label>
          <textarea id="msg" required minlength="10" placeholder="Describe the issue…"></textarea>
        </div>

        <div class="actions">
          <!-- ✅ button id matches JS -->
          <button id="send" type="submit">Send</button>
          <span class="status" id="status"></span>
        </div>

        <p class="warn">✅ Webhook is hidden. Your Discord will receive this message via Google Apps Script.</p>
      </form>
    </div>
  </div>

  <script>
    const API_ENDPOINT = "https://script.google.com/macros/s/AKfycbxH1mHy24Ze6b3JwvnOxgdA9QuxqJD6SDXzeizRFz8bW7SNvswY9lxD6klxyiQe4rnMnQ/exec";

    const form = document.getElementById("f");
    const statusEl = document.getElementById("status");
    const sendBtn = document.getElementById("send");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusEl.textContent = "";
      sendBtn.disabled = true;

      const data = {
        name: document.getElementById("name").value.trim(),
        role: document.getElementById("role").value.trim(),
        contact: document.getElementById("contact").value.trim(),
        category: document.getElementById("cat").value.trim(),
        subject: document.getElementById("subj").value.trim(),
        message: document.getElementById("msg").value.trim(),
        page: location.href
      };

      try{
        const res = await fetch(API_ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });

        const out = await res.json().catch(()=> ({}));
        if(!out.ok) throw new Error(out.error || "Send failed");

        form.reset();
        statusEl.textContent = "✅ Sent!";
      }catch(err){
        statusEl.textContent = "❌ " + (err.message || "Failed to send.");
      }finally{
        sendBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
